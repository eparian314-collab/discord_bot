version: '3.8'

services:
  discord-bot:
    build: .
    container_name: hippobot
    env_file:
      - .env
    volumes:
      - ./data:/app/data
      - ./logs:/app/logs
      - ./cache:/app/cache
      - ./test/data:/app/test/data
    restart: unless-stopped
    environment:
      - TESSERACT_CMD=/usr/bin/tesseract
    networks:
      - bot-network

  # Optional: Stress test runner (run separately)
  stress-test:
    build: .
    container_name: hippobot-stress-test
    env_file:
      - .env
    volumes:
      - ./data:/app/data
      - ./logs:/app/logs
      - ./test:/app/test
      - ./tests:/app/tests
    command: python -m pytest tests/stress/ -v
    profiles:
      - testing
    networks:
      - bot-network

networks:
  bot-network:
    driver: bridge
